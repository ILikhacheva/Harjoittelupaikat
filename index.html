<!DOCTYPE html>
<html lang="fi">
<!--
=====================================================
СИСТЕМА УПРАВЛЕНИЯ МЕСТАМИ ПРАКТИКИ - ГЛАВНАЯ СТРАНИЦА
HARJOITTELUPAIKKOJEN HALLINTAJÄRJESTELMÄ - PÄÄSIVU
=====================================================

Эта страница содержит интерфейс для управления:
Tämä sivu sisältää käyttöliittymän hallintaan:

- Студентов и их данных (добавление, просмотр, редактирование)
  Opiskelijat ja heidän tietonsa (lisäys, katselu, muokkaus)

- Компаний и мест практики (управление для учителей)
  Yritykset ja harjoittelupaikat (hallinta opettajille)

- Системы входа и ролевой авторизации
  Kirjautumisjärjestelmä ja roolipohjainen valtuutus

Роли пользователей / Käyttäjäroolit:
- Студент (3): может видеть только свои данные
  Opiskelija (3): voi nähdä vain omat tietonsa
- Учитель (2): полный доступ к управлению
  Opettaja (2): täysi hallintaoikeus

=====================================================
-->
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Harjoittelupaikat</title>
    <link rel="icon" type="image/png" href="clock.png" />
    <link rel="stylesheet" href="app.css" />
  </head>
  <body>
    <!-- =====================================================
         ЗАГОЛОВОК И НАВИГАЦИЯ
         OTSIKKO JA NAVIGOINTI
         ===================================================== -->
    
    <!-- Объединяем бургер меню и заголовок / Yhdistetään burgeri-valikko ja otsikko -->
    <div class="header">
      <h1>Tervetuloa harjoittelupaikat sivustolle!</h1>
      <div id="burgerMenu" onclick="openSideMenu()">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
      </div>
    </div>
    <div
      id="userGreeting"
      style="
        width: 100%;
        text-align: right;
        font-size: 28px;
        color: #242323;
        display: none;
      "
    ></div>
    </div>
    <div class="divider"></div>
    
    <!-- =====================================================
         ЭКРАН ПРИВЕТСТВИЯ ДЛЯ НЕАВТОРИЗОВАННЫХ ПОЛЬЗОВАТЕЛЕЙ
         TERVETULORUUTU VALTUUTTAMATTOMILLE KÄYTTÄJILLE
         ===================================================== -->
    
    <!-- Показывается когда никто не вошел / Näytetään kun kukaan ei ole kirjautunut -->
    <div id="welcomeGif" style="text-align: center; margin: 50px auto; display: block;">
      <img src="odotta.gif" alt="Odottaa..." style="max-width: 400px; height: auto;">
      <p style="font-size: 48px; font-weight: #32404f; margin-top: 48px;">Kirjaudu sisään nähdäksesi harjoittelupaikat</p>
    </div>
    
    <!-- =====================================================
         БОКОВОЕ МЕНЮ НАВИГАЦИИ
         SIVUNAVIGOINTIVALIKKO
         ===================================================== -->
    <div  
      id="sideMenu"
      class="side-menu"
      style="display: none"
      onmouseleave="closeSideMenu()"
    >
      <!-- Боковое меню кнопок -->
        <div class="side-btn submenu-parent" id="studentsMenuBtn">
          Opiskelijat
          <span class="submenu-arrow">▶</span>
          <div class="submenu" id="studentsSubmenu">
            <button class="submenu-btn" id="addStudentBtn" aria-disabled="true" disabled onclick="openOppilasModal(); closeSideMenu(); event.stopPropagation();">Lisää</button>
            <button class="submenu-btn" id="listStudentBtn" aria-disabled="true" disabled onclick="openStudentListModal(); event.stopPropagation();">Lista</button>
          </div>
        </div>
    <!-- Modal: Student List -->
    <div id="StudentListModalOverlay" class="modal-overlay" style="display: none">
      <div class="modal-window" style="min-width: 420px; max-width: 90vw;">
        <button class="close-btn" onclick="closeStudentListModal()" title="Close">×</button>
        <h2>Opiskelijat</h2>
        
        <!-- Поиск и фильтры для студентов / Haku ja suodattimet opiskelijoille -->
        <div class="student-search-container" style="margin-bottom: 15px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
          <input 
            type="text" 
            id="studentSearchInput" 
            placeholder="Etsi nimellä..."
            style="flex: 1; min-width: 150px; padding: 6px 10px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;"
          />
          <select 
            id="groupFilterSelect" 
            style="padding: 6px 10px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;"
          >
            <option value="">Kaikki ryhmät</option>
          </select>
          <button 
            id="clearStudentFiltersBtn" 
            style="padding: 6px 10px; background: #f0f0f0; border: 1px solid #ccc; border-radius: 4px; cursor: pointer;"
            title="Tyhjennä suodattimet"
          >
            ✖️
          </button>
        </div>
        
        <div class="modal-table-scroll">
          <table border="1" style="width:100%;margin-top:10px;">
            <thead>
              <tr>
                <th class="sortable" data-column="student">
                  Nimi
                  <span class="sort-arrows">
                    <span class="sort-up" onclick="sortStudentTable('student', 'asc')">▲</span>
                    <span class="sort-down" onclick="sortStudentTable('student', 'desc')">▼</span>
                  </span>
                </th>
                <th class="sortable" data-column="surname">
                  Sukunimi
                  <span class="sort-arrows">
                    <span class="sort-up" onclick="sortStudentTable('surname', 'asc')">▲</span>
                    <span class="sort-down" onclick="sortStudentTable('surname', 'desc')">▼</span>
                  </span>
                </th>
                <th>Ryhmä</th>
                <th id="studentActionsHeader" style="display:none;">Toiminnot</th>
              </tr>
            </thead>
            <tbody id="studentListTableBody">
              <!-- Täytetään JS:llä -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
        <div class="side-btn submenu-parent" id="companiesMenuBtn">
          Yritykset
          <span class="submenu-arrow">▶</span>
          <div class="submenu" id="companiesSubmenu">
            <button class="submenu-btn" id="addCompanyBtn" aria-disabled="true" disabled onclick="openYritysModal(); closeSideMenu(); event.stopPropagation();">Lisää</button>
            <button class="submenu-btn" onclick="openCompanyListModal(); closeSideMenu(); event.stopPropagation();">Lista</button>
          </div>
        </div>
        <button class="side-btn" id="addPlaceBtn" aria-disabled="true" disabled onclick="openPaikkaModal(); closeSideMenu();">
          Lisää harjoittelupaikka
        </button>
      <button
        class="side-btn"
        onclick="openReportModal(); closeSideMenu();"
        id="reportBtn"
      >
        Raportti
      </button>
      <button
        class="side-btn"
        onclick="openLoginModal(); closeSideMenu();"
        id="loginBtn"
      >
        Kirjaudu sisään
      </button>
      <button
        class="side-btn"
        onclick="openLogoutModal(); closeSideMenu();"
        id="logoutBtn"
        style="display: none"
      >
        Kirjaudu ulos
      </button>
    </div>
    <!-- Modal: Company List -->
    <div id="CompanyListModalOverlay" class="modal-overlay" style="display: none">
      <div class="modal-window" style="min-width: 420px; max-width: 90vw;">
        <button class="close-btn" onclick="closeCompanyListModal()" title="Close">×</button>
        <h2>Yritykset</h2>

        <!-- Поиск и фильтры для компаний / Haku ja suodattimet yrityksille -->
        <div class="company-search-container" style="margin-bottom: 15px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
          <input 
            type="text" 
            id="companySearchInput" 
            placeholder="Etsi nimellä..."
            style="flex: 1; min-width: 150px; padding: 6px 10px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;"
          />
          <select 
            id="addressFilterSelect" 
            style="padding: 6px 10px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;"
          >
            <option value="">Kaikki osoitteet</option>
          </select>
          <button 
            id="clearCompanyFiltersBtn" 
            style="padding: 6px 10px; background: #f0f0f0; border: 1px solid #ccc; border-radius: 4px; cursor: pointer;"
            title="Tyhjennä suodattimet / Очистить фильтры"
          >
            ✖️
          </button>
        </div>

        <div class="modal-table-scroll">
          <table border="1" style="width:100%;margin-top:10px;">
            <thead>
              <tr>
                <th>Yritys nimi</th>
                <th>Paikkojen määrä</th>
                <th>Y-tunnus</th>
                <th>Osoite</th>
                <th id="companyActionsHeader" style="display:none;">Toiminnot</th>
              </tr>
            </thead>
            <tbody id="companyListTableBody">
              <!-- Täytetään JS:llä -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- =====================================================
         ТАБЛИЦА МЕСТ ПРАКТИКИ С ПОИСКОМ
         HARJOITTELUPAIKKATAULUKKO HAULLA
         ===================================================== -->
    <div id="dataTable" style="display:none;">
      <h2>Harjoittelupaikat</h2>
      
      <!-- Поле поиска / Hakukenttä -->
      <div class="search-container" style="margin-bottom: 15px;">
        <input 
          type="text" 
          id="searchInput" 
          placeholder="Etsi opiskelijaa tai harjoittelupaikkaa..."
          style="width: 100%; max-width: 400px; padding: 8px 12px; font-size: 16px; border: 1px solid #ccc; border-radius: 4px;"
        />
        <button 
          id="clearSearchBtn" 
          style="margin-left: 8px; padding: 8px 12px; background: #f0f0f0; border: 1px solid #ccc; border-radius: 4px; cursor: pointer;"
          title="Tyhjennä haku / Очистить поиск"
        >
          ✖️
        </button>
      </div>
      
      <table border="1">
        <thead>
          <tr>
            <th class="sortable" data-column="student">
              Oppilas 
              <span class="sort-arrows">
                <span class="sort-up" onclick="sortTable('student', 'asc')">▲</span>
                <span class="sort-down" onclick="sortTable('student', 'desc')">▼</span>
              </span>
            </th>
            <th>Paikan nimi</th>
            <th>Ohjaaja</th>
            <th>Puhelin</th>
            <th>Email</th>
            <th>Alku</th>
            <th>Loppu</th>
            <th>Ruokaraha</th>
            <th>Kaupunki</th>
            <th>Status</th>
            <th id="actionsHeader" style="display:none;">Toiminnot</th>
          </tr>
        </thead>
        <tbody id="tableBody">
          <!-- Данные будут подгружаться через JS -->
        </tbody>
      </table>
    </div>

    <!-- Modal ikkuna: uusi opiskelija -->
    <div id="OppilasModalOverlay" class="modal-overlay" style="display: none">
      <div id="OppilasModal" class="modal-window">
        <button class="close-btn" onclick="closeOppilasModal()" title="Close">
          ×
        </button>
        <h2>Uusi opiskelija</h2>
        <form id="oppilas-form" method="post" action="#">
          <div class="form-group">
            <label for="OppilasNimi">Oppilaan nimi:</label>
            <input type="text" id="OppilasNimi" name="OppilasNimi" required />
          </div>
          <div class="form-group">
            <label for="OppilasSukunimi">Oppilaan sukunimi:</label>
            <input type="text" id="OppilasSukunimi" name="OppilasSukunimi" required />
          </div>
          <div class="form-group">
            <label for="RyhmanNimi">Ryhmä:</label>
            <input type="text" id="RyhmanNimi" name="RyhmanNimi" required />
          </div>
          <div class="buttons">
            <button type="submit" class="btn btn-primary">Tallenna</button>
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeOppilasModal()"
            >
              Peruuta
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal ikkuna: uusi paikka -->
    <div id="PaikkaModalOverlay" class="modal-overlay" style="display: none">
      <div id="PaikkaModal" class="modal-window">
        <button class="close-btn" onclick="closePaikkaModal()" title="Close">
          ×
        </button>
        <h2>Uusi harjoittelupaikka</h2>
        <form id="paikka-form" method="post" action="#">
          <div class="form-group">
            <label for="Oppilas">Oppilas:</label>
            <select id="OppilasLista" name="Oppilas" required>
              <option value="-1">Valitse opiskelija...</option>
            </select>
          </div>
          <div class="form-group">
            <label for="PaikanNimi">Paikan nimi:</label>
            <select id="PaikanNimi" name="PaikanNimi" required>
              <option value="-1">Valitse paikka...</option>
            </select>
          </div>
          <div class="form-group">
            <label for="Ohjaaja">Ohjaaja:</label>
            <input type="text" id="Ohjaaja" name="Ohjaaja" />
          </div>
          <div class="form-group">
            <label for="Puhelin">Puhelin:</label>
            <input type="tel" id="Puhelin" name="Puhelin" placeholder="+358 XX XXX XXXX" />
          </div>
          <div class="form-group">
            <label for="Email">Email:</label>
            <input type="email" id="Email" name="Email" placeholder="nimi@domain.com" />
          </div>
          <div class="form-group">
            <label for="Alku">Alku:</label>
            <input type="date" id="Alku" name="Alku" />
          </div>
          <div class="form-group">
            <label for="Loppu">Loppu:</label>
            <input type="date" id="Loppu" name="Loppu" />
          </div>
          <div class="form-group">
            <label for="Ruokaraha">Ruokaraha:</label>
            <select id="Ruokaraha" name="Ruokaraha" required>
              <option value="">Valitse...</option>
              <option value="true">Kyllä</option>
              <option value="false">Ei</option>
            </select>
          </div>
          <div class="form-group">
            <label for="Kaupunki">Kaupunki:</label>
            <input type="text" id="Kaupunki" name="Kaupunki" />
          </div>
          <div class="form-group">
            <label for="Status">Status:</label>
            <select id="Status" name="Status" required>
              <option value="">Valitse...</option>
              <option value="On">On</option>
              <option value="Odottaa">Odottaa</option>
              <option value="Ei">Ei</option>
            </select>
          </div>
          <div class="buttons">
            <button type="submit" class="btn btn-primary">Tallenna</button>
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closePaikkaModal()"
            >
              Peruuta
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal ikkuna: uusi yritys -->
    <div id="YritysModalOverlay" class="modal-overlay" style="display: none">
      <div id="YritysModal" class="modal-window">
        <button class="close-btn" onclick="closeYritysModal()" title="Close">
          ×
        </button>
        <h2>Uusi yritys</h2>
        <form id="yritys-form" method="post" action="#">
          <div class="form-group">
            <label for="YrityksenNimi">Yrityksen nimi:</label>
            <input
              type="text"
              id="YrityksenNimi"
              name="YrityksenNimi"
              required
            />
          </div>
          <div class="form-group">
            <label for="PaikkojenMaara">Paikkojen määrä:</label>
            <input
              type="number"
              id="PaikkojenMaara"
              name="PaikkojenMaara"
              required
            />
          </div>
          <div class="form-group">
            <label for="YrityksenTunnus">Yrityksen tunnus:</label>
            <input
              type="text"
              id="YrityksenTunnus"
              name="YrityksenTunnus"
              required
            />
          </div>
          <div class="form-group">
            <label for="YrityksenOsoite">Osoite:</label>
            <input
              type="text"
              id="YrityksenOsoite"
              name="YrityksenOsoite"
              required
            />
          </div>
          <div class="buttons">
            <button type="submit" class="btn btn-primary">Tallenna</button>
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeYritysModal()"
            >
              Peruuta
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal ikkuna: uusi kayttaja -->
    <div id="UsersModalOverlay" class="modal-overlay" style="display: none">
      <div id="UsersModal" class="modal-window">
        <button class="close-btn" onclick="closeUsersModal()" title="Close">
          ×
        </button>
        <h2>Rekisteröinti</h2>
        <form id="Users-form" method="post" action="#">
          <div class="form-group">
            <label>Rooli:</label>
            <div style="display: flex; gap: 16px; align-items: center">
              <label style="margin: 0">
                <input
                  type="radio"
                  id="roleStudent"
                  name="UserRole"
                  value="student"
                  checked
                />
                Oppilas
              </label>
              <label style="margin: 0">
                <input
                  type="radio"
                  id="roleTeacher"
                  name="UserRole"
                  value="teacher"
                />
                Opettaja
              </label>
            </div>
          </div>
          <div class="form-group" id="studentSelectGroup">
            <label for="UserStudentSelect">Valitse opiskelija:</label>
            <select id="UserStudentSelect" name="UserStudentSelect" required>
              <option value="">Valitse...</option>
            </select>
          </div>
          <div class="form-group" id="teacherNameGroup" style="display: none">
            <label for="UserNimiTeacher">Nimi:</label>
            <input type="text" id="UserNimiTeacher" name="UserNimiTeacher" />
          </div>
          <div class="form-group" id="UserEmailGroup">
            <label for="UserEmail">Sähköposti:</label>
            <input type="email" id="UserEmail" name="UserEmail" placeholder="nimi@domain.com" />
          </div>
          <div class="form-group" id="UserPasswordGroup">
            <label for="UserPassword">Salasana:</label>
            <input
              type="password"
              id="UserPassword"
              name="UserPassword"
              required
            />
          </div>
          <div class="form-group" id="teacherCodeGroup" style="display: none">
            <label for="TeacherCode">Koodisana:</label>
            <input type="password" id="TeacherCode" name="TeacherCode" />
            <span id="codeError" style="color: red; display: none"
              >Koodisana ei ole oikea</span
            >
          </div>
          <div class="buttons">
            <button type="submit" class="btn btn-primary">Tallenna</button>
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeUsersModal()"
            >
              Peruuta
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal: Report -->
    <div id="ReportModalOverlay" class="modal-overlay" style="display: none">
      <div class="modal-window" style="max-width: 95%; width: 1200px;">
        <button class="close-btn" onclick="closeReportModal()" title="Close">×</button>
        <h2>Harjoittelupaikkaraportti</h2>
        
        <div style="margin-bottom: 15px; text-align: center;">
          <button id="generateReportBtn" onclick="generateReport()" style="padding: 10px 20px; background: #357ab8; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">
            Opiskelijaraportti
          </button>
          <button id="generateCompanyReportBtn" onclick="generateCompanyReport()" style="padding: 10px 20px; background: #6f42c1; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">
            Yritysraportti
          </button>
          <button id="exportPdfBtn" onclick="exportToPdf()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; display: none;">
            Tallenna PDF
          </button>
        </div>

        <div id="reportContent" style="background: white; padding: 20px; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
          <p style="text-align: center; color: #666;">Klikkaa 'Luo raportti' -painiketta luodaksesi raportin.</p>
        </div>
      </div>
    </div>

    <!-- Modal: Login -->
    <div id="LoginModalOverlay" class="modal-overlay" style="display: none">
      <div class="modal-window">
        <button class="close-btn" onclick="closeLoginModal()" title="Close">
          ×
        </button>
        <h2>Kirjaudu sisään</h2>
        <form id="login-form" method="post" action="#">
          <div class="form-group">
            <label for="loginEmail">Sähköposti:</label>
            <input type="email" id="loginEmail" name="loginEmail" placeholder="nimi@domain.com" required />
          </div>
          <div class="form-group">
            <label for="loginPassword">Salasana:</label>
            <input
              type="password"
              id="loginPassword"
              name="loginPassword"
              required
            />
          </div>
          <div class="buttons">
            <button type="submit" class="btn btn-primary">Kirjaudu</button>
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeLoginModal()"
            >
              Peruuta
            </button>
            <button
              type="button"
              class="btn btn-link"
              style="
                background: none;
                border: none;
                color: #357ab8;
                text-decoration: underline;
                cursor: pointer;
                padding-left: 0;
              "
              onclick="closeLoginModal(); openKirjauduModal();"
            >
              Rekisteröidy
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal: Logout -->
    <div id="LogoutModalOverlay" class="modal-overlay" style="display: none">
      <div class="modal-window">
        <button class="close-btn" onclick="closeLogoutModal()" title="Close">
          ×
        </button>
        <h2>Kirjaudu ulos</h2>
        <p>Haluatko varmasti kirjautua ulos?</p>
        <div class="buttons">
          <button
            type="button"
            class="btn btn-primary"
            onclick="logoutUser()"
          >
            Kyllä
          </button>
          <button
            type="button"
            class="btn btn-secondary"
            onclick="closeLogoutModal()"
          >
            Peruuta
          </button>
        </div>
      </div>
    </div>
    
    <footer>
      <div class="divider-footer"></div>
      <div>
        <a href="https://www.kpedu.fi/" title="Meistä" target="_blank"
          >https://www.kpedu.fi/</a
        >
        <p> </p>
        <a href="mailto:anders.wikberg@kpedu.fi" title="Lähetä sähköpostia">
          anders.wikberg@kpedu.fi</a
        >
        <p>© 2025 Harjoittelupaikat</p>
      </div>
    </footer>
    <script src="app.js"></script>
  </body>
</html>
